<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Thi·∫øt l·∫≠p l·ªãch r·∫£nh</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/student-dashboard.css">
    <link rel="stylesheet" href="../css/tutor-custom.css">
    
    <!-- CSS Ri√™ng cho Calendar -->
    <style>
        .calendar-wrapper {
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 20px;
            user-select: none; /* NgƒÉn b√¥i ƒëen text khi click nhi·ªÅu */
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #eee;
            padding: 10px 20px;
            border-bottom: 1px solid #ccc;
            font-weight: bold;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            border-left: 1px solid #ddd;
            border-top: 1px solid #ddd;
        }

        .cal-cell {
            min-height: 100px;
            border-right: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
            padding: 10px;
            position: relative;
            cursor: context-menu; /* Icon chu·ªôt ph·∫£i */
        }

        .cal-head {
            text-align: center;
            padding: 10px;
            font-weight: bold;
            background: #fff;
            border-right: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
        }

        .date-num {
            font-size: 14px;
            font-weight: 500;
        }

        /* C√°c tr·∫°ng th√°i m√†u */
        .status-free { background-color: #ccffcc; } /* Xanh l√° nh·∫°t - L·ªãch r·∫£nh */
        .status-opened { background-color: #ffffcc; } /* V√†ng nh·∫°t - ƒê√£ m·ªü */
    /*   .status-busy { background-color: #333; color: white; }  ƒêen - L·ªãch tr√¨nh */

        /* Context Menu (Menu chu·ªôt ph·∫£i) */
        #context-menu {
            display: none;
            position: absolute;
            z-index: 1000;
            width: 150px;
            background: white;
            border: 1px solid #ccc;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            border-radius: 4px;
        }

        #context-menu ul { list-style: none; padding: 0; margin: 0; }
        #context-menu li {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            font-size: 13px;
        }
        #context-menu li:hover { background-color: #f0f0f0; }
        #context-menu li:last-child { border-bottom: none; }

        .legend-box {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            justify-content: center;
            border: 1px solid #ccc;
            padding: 10px;
            background: #fff;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }
        .legend-item { display: flex; align-items: center; gap: 5px; font-size: 13px; }
        .color-box { width: 30px; height: 15px; border: 1px solid #999; }
    </style>
</head>
<body>
    <div class="app" style="height: 100%;">
        <!-- Sidebar -->
        <div id="sidebar-container"></div>

        <main class="main">
            <!-- Topbar -->
            <div id="topbar-container"></div>

            <div class="breadcrumb-bar">
                <span class="material-icons">edit_calendar</span>
                <span>Thi·∫øt l·∫≠p l·ªãch r·∫£nh</span>
            </div>
            
            <div class="content">
                <div class="breadcrumb-back" style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-top: -15px;">
                        <span class="material-icons">reply</span>
                        <a href="dashboard.html">Tr·ªü v·ªÅ trang tr∆∞·ªõc</a>
                    </div>
                    <button onclick="openAddScheduleModal()" style="background: #4A7FA7; color: white; border: none; padding: 10px 20px; border-radius: 4px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                        <span class="material-icons" style="font-size: 20px; color: white;">add_circle</span>
                        Th√™m l·ªãch r·∫£nh
                    </button>
                </div>

                <!-- CALENDAR UI -->
                <div class="calendar-wrapper">
                    <!-- Header -->
                    <div class="calendar-header">
                        <span class="material-icons" style="cursor:pointer" onclick="changeMonth(-1)">arrow_left</span>
                        <span id="current-month-year">December 2025</span>
                        <span class="material-icons" style="cursor:pointer" onclick="changeMonth(1)">arrow_right</span>
                    </div>

                    <!-- Grid -->
                    <div class="calendar-grid" id="calendar-body">
                        <!-- JS s·∫Ω render √¥ ng√†y v√†o ƒë√¢y -->
                    </div>
                </div>

                <!-- Ch√∫ th√≠ch -->
                <div class="legend-box">
                    <span style="font-weight:bold; margin-right:10px;">Ch√∫ th√≠ch:</span>
                    <div class="legend-item">
                        <div class="color-box" style="background:#ffffcc"></div> ƒê√£ m·ªü
                    </div>
                    <div class="legend-item">
                        <div class="color-box" style="background:#ccffcc"></div> L·ªãch r·∫£nh
                    </div>
                    <!--div class="legend-item">
                        <div class="color-box" style="background:#333"></div> L·ªãch tr√¨nh
                    </div-->
                </div>
            </div>
        </main>
    </div>

    <!-- CUSTOM CONTEXT MENU (Menu chu·ªôt ph·∫£i) -->
    <div id="context-menu">
        <ul>
            <li onclick="setDayStatus('free')">üü¢ L·ªãch r·∫£nh (Xanh)</li>
            <li onclick="setDayStatus('opened')">üü° ƒê√£ m·ªü (V√†ng)</li>
            <!--li onclick="setDayStatus('busy')">‚ö´ L·ªãch tr√¨nh (ƒêen)</li-->
            <li onclick="setDayStatus(null)">‚ö™ X√≥a (None)</li>
        </ul>
    </div>

    <script src="../js/api-client.js"></script>
    <script src="../js/components-loader.js"></script>
    <script src="../js/tutor-availability.js"></script>
    <!-- <div class="modal-overlay" id="openSessionModal">
        <div class="modal-form-content">
            <div class="modal-title">M·ªû BU·ªîI H·ªåC HO·∫∂C T∆Ø V·∫§N</div>
            
            <form id="sessionForm">
                <div class="form-row">
                    <label>T√™n bu·ªïi h·ªçc/t∆∞ v·∫•n</label>
                    <input type="text" class="form-input" id="sessionName" placeholder="T√™n">
                </div>
                
                <div class="form-row">
                    <label>Th·ªùi gian</label>
                    <input type="text" class="form-input" id="sessionTime" placeholder="Th·ªùi gian">
                </div>
                
                <div class="form-row">
                    <label>H√¨nh th·ª©c</label>
                    <div class="checkbox-group" style="margin-top:5px;">
                        <label style="display:flex; align-items:center; font-weight:normal; margin-right:30px;">
                            <input type="checkbox" class="custom-checkbox"> Offline
                        </label>
                        <label style="display:flex; align-items:center; font-weight:normal;">
                            <input type="checkbox" class="custom-checkbox"> Online
                        </label>
                    </div>
                </div>

                <div class="form-row">
                    <label>Link (t√πy ch·ªçn)</label>
                    <input type="text" class="form-input" placeholder="Link">
                </div>

                <div class="form-row">
                    <label>M√¥ t·∫£ bu·ªïi h·ªçc/t∆∞ v·∫•n</label>
                    <textarea class="form-input" style="height:100px; resize:none;" placeholder="M√¥ t·∫£"></textarea>
                </div>

                <div style="display:flex; justify-content:space-between; margin-top:30px;">
                    <button type="button" onclick="closeModals()" style="padding:10px 40px; border:1px solid #ccc; background:#eee; cursor:pointer; font-weight:600;">H·ªßy</button>
                    
                    <button type="button" onclick="confirmOpenSession()" class="btn-open-session">
                        <span class="material-icons">open_in_new</span> M·ªü bu·ªïi h·ªçc
                    </button>
                </div>
            </form>
        </div>
    </div> -->

<!-- <div class="modal-form-content">
            <div class="modal-title">M·ªû BU·ªîI H·ªåC HO·∫∂C T∆Ø V·∫§N</div>
            <form id="sessionForm"> -->
                <!-- ... c√°c input c≈© ... -->
                <!-- <div class="form-row">
                    <label>T√™n bu·ªïi h·ªçc/t∆∞ v·∫•n</label>
                    <input type="text" class="form-input" id="sessionName" placeholder="T√™n">
                </div>
                <div class="form-row">
                    <label>Th·ªùi gian</label>
                    <input type="text" class="form-input" id="sessionTime" placeholder="Th·ªùi gian">
                </div> -->
                <!-- ... -->
                <!-- <div style="display:flex; justify-content:space-between; margin-top:30px;">
                    <button type="button" onclick="closeModals()" style="padding:10px 40px; border:1px solid #ccc; background:#eee; cursor:pointer; font-weight:600;">H·ªßy</button>
                    <button type="button" onclick="confirmOpenSession()" class="btn-open-session">
                        <span class="material-icons">open_in_new</span> M·ªü bu·ªïi h·ªçc
                    </button>
                </div>
            </form>
        </div> -->
    </div>

    <!-- 2. MODAL NH·∫¨P GI·ªú (CHO L·ªäCH R·∫¢NH - M√ÄU XANH) -->
    <div class="modal-overlay" id="freeTimeModal">
        <div class="modal-small-content">
            <div class="modal-small-title">Thi·∫øt l·∫≠p l·ªãch r·∫£nh</div>
            <p class="modal-msg">Vui l√≤ng nh·∫≠p khung gi·ªù b·∫°n r·∫£nh:</p>
            
            <div class="form-row">
                <input type="text" id="inputFreeTime" class="form-input" placeholder="VD: 08:00 - 11:30" style="text-align: center;">
            </div>

            <div style="display:flex; justify-content:center; gap:15px; margin-top:20px;">
                <button onclick="closeModals()" class="btn-cancel-gray">H·ªßy</button>
                <button onclick="confirmSetFree()" class="btn-confirm-blue">X√°c nh·∫≠n</button>
            </div>
        </div>
    </div>

    <!-- 3. MODAL X√ÅC NH·∫¨N X√ìA (CLEAR) -->
    <div class="modal-overlay" id="deleteConfirmModal">
        <div class="modal-small-content">
            <div class="modal-small-title" style="color:#d32f2f;">X√°c nh·∫≠n x√≥a</div>
            <p class="modal-msg">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a tr·∫°ng th√°i c·ªßa ng√†y n√†y?</p>
            
            <div style="display:flex; justify-content:center; gap:15px; margin-top:20px;">
                <button onclick="closeModals()" class="btn-cancel-gray">H·ªßy</button>
                <button onclick="confirmDelete()" class="btn-confirm-red">X√≥a</button>
            </div>
        </div>
    </div>

    <!-- 4. MODAL TH√äM L·ªäCH R·∫¢NH M·ªöI -->
    <div class="modal-overlay" id="addScheduleModal">
        <div class="modal-form-content" style="width: 500px;">
            <div class="modal-title">TH√äM L·ªäCH R·∫¢NH</div>
            
            <form id="addScheduleForm">
                <div class="form-row">
                    <label>Ch·ªçn ng√†y</label>
                    <input type="date" class="form-input" id="newScheduleDate" required>
                </div>
                
                <div class="form-row">
                    <label>Th·ªùi gian b·∫Øt ƒë·∫ßu</label>
                    <input type="time" class="form-input" id="newScheduleStartTime" required>
                </div>
                
                <div class="form-row">
                    <label>Th·ªùi gian k·∫øt th√∫c</label>
                    <input type="time" class="form-input" id="newScheduleEndTime" required>
                </div>
                
                <!--div class="form-row">
                    <label>ƒê·ªãa ƒëi·ªÉm (t√πy ch·ªçn)</label>
                    <input type="text" class="form-input" id="newScheduleLocation" placeholder="VD: H1-101 ho·∫∑c Google Meet">
                </div>
                
                <div class="form-row">
                    <label>Lo·∫°i</label>
                    <div class="checkbox-group" style="margin-top:5px;">
                        <label style="display:flex; align-items:center; font-weight:normal; margin-right:30px;">
                            <input type="radio" name="scheduleType" value="offline" checked> Offline
                        </label>
                        <label style="display:flex; align-items:center; font-weight:normal;">
                            <input type="radio" name="scheduleType" value="online"> Online
                        </label>
                    </div>
                </div>
                
                <div class="form-row">
                    <label>Ghi ch√∫ (t√πy ch·ªçn)</label>
                    <textarea class="form-input" id="newScheduleNote" style="height:80px; resize:none;" placeholder="Ghi ch√∫ th√™m v·ªÅ l·ªãch r·∫£nh n√†y..."></textarea>
                </div-->

                <div style="display:flex; justify-content:space-between; margin-top:30px;">
                    <button type="button" onclick="closeModals()" style="padding:10px 40px; border:1px solid #ccc; background:#eee; cursor:pointer; font-weight:600;">H·ªßy</button>
                    
                    <button type="button" onclick="submitNewSchedule()" style="padding:10px 30px; border:none; background:#4A7FA7; color:white; cursor:pointer; font-weight:600; border-radius:4px; display:flex; align-items:center; gap:8px;">
                        <span class="material-icons" style="font-size:20px;">check_circle</span>
                        X√°c nh·∫≠n
                    </button>
                </div>
            </form>
        </div>
    </div>

   <!--div class="modal-overlay" id="scheduleConfirmModal">
        <div class="modal-small-content">
            <div class="modal-small-title" style="color:#333;">X√°c nh·∫≠n l·ªãch tr√¨nh</div>
            <p class="modal-msg">X√°c nh·∫≠n ƒë√°nh d·∫•u ng√†y n√†y l√† c√≥ L·ªãch tr√¨nh (B·∫≠n)?</p>
            
            <div style="display:flex; justify-content:center; gap:15px; margin-top:20px;">
                < N√∫t H·ªßy: d√πng closeModals() >
                <button type="button" onclick="closeModals()" class="btn-cancel-gray">H·ªßy</button>
                < N√∫t X√°c nh·∫≠n: g·ªçi h√†m m·ªõi confirmSetBusy() >
                <button type="button" onclick="confirmSetBusy()" class="btn-confirm-black">X√°c nh·∫≠n</button>
            </div>
        </div>
    </div-->

    <script src="../js/api-client.js"></script>
    <script src="../js/components-loader.js"></script>
    <script src="../js/tutor-availability.js"></script>
</body>
</html>